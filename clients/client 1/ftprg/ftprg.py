from pyspark.sql.types import *
import sys
sys.path.insert(0, "/opt/spark/work-dir")

from extract.KafkaServer import KafkaServer
from pyspark.sql.functions import from_json

class FtpRgDD:
    TOPIC = 'Client2_Debezium.datadriven_Client2.dbo.ftp_rg'
        
    SCHEMA = StructType([
        StructField("before", StringType()),
        StructField("after", StringType()),
        StructField("id", LongType()),
        StructField("rg", StringType()),
        StructField("luva", DecimalType()),
        StructField("luva_min", DecimalType()),
        StructField("luva_max", DecimalType()),
        StructField("ponta", IntegerType()),
        StructField("ponta_min", DecimalType()),
        StructField("ponta_max", DecimalType()),
        StructField("cabecote1", IntegerType()),
        StructField("cabecote1min", IntegerType()),
        StructField("cabecote1max", IntegerType()),
        StructField("cabecote2", IntegerType()),
        StructField("cabecote2min", IntegerType()),
        StructField("cabecote2max", IntegerType()),
        StructField("cabecote3", IntegerType()),
        StructField("cabecote3min", IntegerType()),
        StructField("cabecote3max", IntegerType()),
        StructField("cabecote4", IntegerType()),
        StructField("cabecote4min", IntegerType()),
        StructField("cabecote4max", IntegerType()),
        StructField("cabecote5", IntegerType()),
        StructField("cabecote5min", IntegerType()),
        StructField("cabecote5max", IntegerType()),
        StructField("a_cil1", IntegerType()),
        StructField("a_cil1min", IntegerType()),
        StructField("a_cil1max", IntegerType()),
        StructField("a_cil2", IntegerType()),
        StructField("a_cil2min", IntegerType()),
        StructField("a_cil2max", IntegerType()),
        StructField("a_cil3", IntegerType()),
        StructField("a_cil3min", IntegerType()),
        StructField("a_cil3max", IntegerType()),
        StructField("a_adapter", IntegerType()),
        StructField("a_adapter_min", IntegerType()),
        StructField("a_adapter_max", IntegerType()),
        StructField("b_cil1", IntegerType()),
        StructField("b_cil1min", IntegerType()),
        StructField("b_cil1max", IntegerType()),
        StructField("b_cil2", IntegerType()),
        StructField("b_cil2min", IntegerType()),
        StructField("b_cil2max", IntegerType()),
        StructField("b_cil3", IntegerType()),
        StructField("b_cil3min", IntegerType()),
        StructField("b_cil3max", IntegerType()),
        StructField("b_cil4", IntegerType()),
        StructField("b_cil4min", IntegerType()),
        StructField("b_cil4max", IntegerType()),
        StructField("b_cil5", IntegerType()),
        StructField("b_cil5min", IntegerType()),
        StructField("b_cil5max", IntegerType()),
        StructField("b_adapter", IntegerType()),
        StructField("b_adapter_min", IntegerType()),
        StructField("b_adapter_max", IntegerType()),
        StructField("c_cil1", IntegerType()),
        StructField("c_cil1min", IntegerType()),
        StructField("c_cil1max", IntegerType()),
        StructField("c_cil2", IntegerType()),
        StructField("c_cil2min", IntegerType()),
        StructField("c_cil2max", IntegerType()),
        StructField("c_cil3", IntegerType()),
        StructField("c_cil3min", IntegerType()),
        StructField("c_cil3max", IntegerType()),
        StructField("c_adapter", IntegerType()),
        StructField("c_adapter_min", IntegerType()),
        StructField("c_adapter_max", IntegerType()),
        StructField("iniciar_extrusora_a", IntegerType()),
        StructField("producao_extrusora_a", IntegerType()),
        StructField("producao_extrusora_a_min", IntegerType()),
        StructField("producao_extrusora_a_max", IntegerType()),
        StructField("iniciar_extrusora_b", IntegerType()),
        StructField("producao_extrusora_b", IntegerType()),
        StructField("producao_extrusora_b_min", IntegerType()),
        StructField("producao_extrusora_b_max", IntegerType()),
        StructField("iniciar_extrusora_c", IntegerType()),
        StructField("producao_extrusora_c", IntegerType()),
        StructField("producao_extrusora_c_min", IntegerType()),
        StructField("producao_extrusora_c_max", IntegerType()),
        StructField("trafila_peso", IntegerType()),
        StructField("trafila_peso_min", IntegerType()),
        StructField("trafila_peso_max", IntegerType()),
        StructField("trafila_abertura_cone", IntegerType()),
        StructField("trafila_abertura_cone_min", IntegerType()),
        StructField("trafila_abertura_cone_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_dir", IntegerType()),
        StructField("micro_furo_peencher_tempo_dir_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_dir_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_esq", IntegerType()),
        StructField("micro_furo_peencher_tempo_esq_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_esq_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_dir", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_dir_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_dir_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_esq", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_esq_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_equalizacao_esq_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_dir", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_dir_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_dir_max", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_esq", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_esq_min", IntegerType()),
        StructField("micro_furo_peencher_tempo_verificacao_esq_max", IntegerType()),
        StructField("rejeicao_por_furo", IntegerType()),
        StructField("micro_furo2nd_pos_res", IntegerType()),
        StructField("pressao_do_micro_furo_dir", DecimalType()),
        StructField("pressao_do_micro_furo_dir_min", DecimalType()),
        StructField("pressao_do_micro_furo_dir_max", IntegerType()),
        StructField("pressao_do_micro_furo_esq", DecimalType()),
        StructField("pressao_do_micro_furo_esq_min", DecimalType()),
        StructField("pressao_do_micro_furo_esq_max", IntegerType()),
        StructField("pressao1p1dir", IntegerType()),
        StructField("pressao1p1esq", IntegerType()),
        StructField("pressao2p2dir", IntegerType()),
        StructField("pressao2p2esq", IntegerType()),
        StructField("ret_fechar_molde_esq", IntegerType()),
        StructField("ret_fechar_molde_esq_min", DecimalType()),
        StructField("ret_fechar_molde_esq_max", DecimalType()),
        StructField("ret_fechar_molde_dir", IntegerType()),
        StructField("ret_fechar_molde_dir_min", DecimalType()),
        StructField("ret_fechar_molde_dir_max", DecimalType()),
        StructField("ret_sub_pino_sopro_esq", IntegerType()),
        StructField("ret_sub_pino_sopro_esq_min", IntegerType()),
        StructField("ret_sub_pino_sopro_esq_max", DecimalType()),
        StructField("ret_sub_pino_sopro_dir", IntegerType()),
        StructField("ret_sub_pino_sopro_dir_min", IntegerType()),
        StructField("ret_sub_pino_sopro_dir_max", DecimalType()),
        StructField("ret_recuo_carro_esq", DecimalType()),
        StructField("ret_recuo_carro_esq_min", DecimalType()),
        StructField("ret_recuo_carro_esq_max", DecimalType()),
        StructField("ret_recuo_carro_dir", DecimalType()),
        StructField("ret_recuo_carro_dir_min", DecimalType()),
        StructField("ret_recuo_carro_dir_max", DecimalType()),
        StructField("ret_decida_pino_sopro_esq", DecimalType()),
        StructField("ret_decida_pino_sopro_esq_min", DecimalType()),
        StructField("ret_decida_pino_sopro_esq_max", DecimalType()),
        StructField("ret_decida_pino_sopro_dir", DecimalType()),
        StructField("ret_decida_pino_sopro_dir_min", DecimalType()),
        StructField("ret_decida_pino_sopro_dir_max", DecimalType()),
        StructField("ret_decida_pino_lento_esq", DecimalType()),
        StructField("ret_decida_pino_lento_esq_min", DecimalType()),
        StructField("ret_decida_pino_lento_esq_max", DecimalType()),
        StructField("ret_decida_pino_lento_dir", DecimalType()),
        StructField("ret_decida_pino_lento_dir_min", DecimalType()),
        StructField("ret_decida_pino_lento_dir_max", DecimalType()),
        StructField("ret_sopro_esq", IntegerType()),
        StructField("ret_sopro_esq_min", DecimalType()),
        StructField("ret_sopro_esq_max", DecimalType()),
        StructField("tempo_sopro_esq", IntegerType()),
        StructField("tempo_sopro_dir", IntegerType()),
        StructField("tempo_de_descarga_esq", DecimalType()),
        StructField("tempo_de_descarga_esq_min", DecimalType()),
        StructField("tempo_de_descarga_esq_max", DecimalType()),
        StructField("tempo_de_descarga_dir", DecimalType()),
        StructField("tempo_de_descarga_dir_min", DecimalType()),
        StructField("tempo_de_descarga_dir_max", DecimalType()),
        StructField("ret_rebarbador_esq", IntegerType()),
        StructField("ret_rebarbador_esq_min", IntegerType()),
        StructField("ret_rebarbador_esq_max", IntegerType()),
        StructField("ret_rebarbador_dir", IntegerType()),
        StructField("ret_rebarbador_dir_min", IntegerType()),
        StructField("ret_rebarbador_dir_max", IntegerType()),
        StructField("ret_resfr_rebarbador_esq", DecimalType()),
        StructField("ret_resfr_rebarbador_esq_min", DecimalType()),
        StructField("ret_resfr_rebarbador_esq_max", DecimalType()),
        StructField("ret_resfr_rebarbador_dir", DecimalType()),
        StructField("ret_resfr_rebarbador_dir_min", DecimalType()),
        StructField("ret_resfr_rebarbador_dir_max", DecimalType()),
        StructField("tempo_reb_avanco_esq", IntegerType()),
        StructField("tempo_reb_avanco_esq_min", IntegerType()),
        StructField("tempo_reb_avanco_esq_max", DecimalType()),
        StructField("tempo_reb_avanco_dir", IntegerType()),
        StructField("tempo_reb_avanco_dir_min", IntegerType()),
        StructField("tempo_reb_avanco_dir_max", DecimalType()),
        StructField("t_rebarbador_alca_avancado_esq", IntegerType()),
        StructField("t_rebarbador_alca_avancado_esq_min", DecimalType()),
        StructField("t_rebarbador_alca_avancado_esq_max", DecimalType()),
        StructField("ret_fechar_garra_pino_de_sopro_esq", IntegerType()),
        StructField("ret_fechar_garra_pino_de_sopro_esq_min", IntegerType()),
        StructField("ret_fechar_garra_pino_de_sopro_esq_max", IntegerType()),
        StructField("ret_fechar_garra_pino_de_sopro_dir", IntegerType()),
        StructField("ret_fechar_garra_pino_de_sopro_dir_min", IntegerType()),
        StructField("ret_fechar_garra_pino_de_sopro_dir_max", IntegerType()),
        StructField("t_descompressao_esq", DecimalType()),
        StructField("t_descompressao_esq_min", DecimalType()),
        StructField("t_descompressao_esq_max", DecimalType()),
        StructField("t_descompressao_dir", DecimalType()),
        StructField("t_descompressao_dir_min", DecimalType()),
        StructField("t_descompressao_dir_max", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_esq", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_esq_min", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_esq_max", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_dir", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_dir_min", DecimalType()),
        StructField("t_pre_recuo_pino_sopro_dir_max", DecimalType()),
        StructField("ret_abrir_molde_esq", DecimalType()),
        StructField("ret_abrir_molde_esq_min", IntegerType()),
        StructField("ret_abrir_molde_esq_max", DecimalType()),
        StructField("ret_abrir_molde_dir", DecimalType()),
        StructField("ret_abrir_molde_dir_min", IntegerType()),
        StructField("ret_abrir_molde_dir_max", DecimalType()),
        StructField("ret_descida2nd_pino_sopro_esq", IntegerType()),
        StructField("ret_descida2nd_pino_sopro_esq_min", IntegerType()),
        StructField("ret_descida2nd_pino_sopro_esq_max", DecimalType()),
        StructField("ret_descida2nd_pino_sopro_dir", IntegerType()),
        StructField("ret_descida2nd_pino_sopro_dir_min", IntegerType()),
        StructField("ret_descida2nd_pino_sopro_dir_max", DecimalType()),
        StructField("recuar_vacuo_pinca_esq", DecimalType()),
        StructField("recuar_vacuo_pinca_esq_min", DecimalType()),
        StructField("recuar_vacuo_pinca_esq_max", DecimalType()),
        StructField("recuar_vacuo_pinca_dir", DecimalType()),
        StructField("recuar_vacuo_pinca_dir_min", DecimalType()),
        StructField("recuar_vacuo_pinca_dir_max", DecimalType()),
        StructField("t_lubrificacao_esq", IntegerType()),
        StructField("t_lubrificacao_esq_min", IntegerType()),
        StructField("t_lubrificacao_esq_max", IntegerType()),
        StructField("t_lubrificacao_dir", IntegerType()),
        StructField("t_lubrificacao_dir_min", IntegerType()),
        StructField("t_lubrificacao_dir_max", IntegerType()),
        StructField("ret_alta_pressao_esq", DecimalType()),
        StructField("ret_alta_pressao_esq_min", DecimalType()),
        StructField("ret_alta_pressao_esq_max", DecimalType()),
        StructField("ret_alta_pressao_dir", DecimalType()),
        StructField("ret_alta_pressao_dir_min", DecimalType()),
        StructField("ret_alta_pressao_dir_max", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_esq", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_esq_min", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_esq_max", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_dir", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_dir_min", DecimalType()),
        StructField("ret_descida_pinca_inicio_ciclo_dir_max", DecimalType()),
        StructField("t_espera_reb_superior_esq", DecimalType()),
        StructField("t_espera_reb_superior_esq_min", DecimalType()),
        StructField("t_espera_reb_superior_esq_max", DecimalType()),
        StructField("t_espera_reb_superior_dir", DecimalType()),
        StructField("t_espera_reb_superior_dir_min", DecimalType()),
        StructField("t_espera_reb_superior_dir_max", DecimalType()),
        StructField("t_espera_reb_fundo_esq", DecimalType()),
        StructField("t_espera_reb_fundo_esq_min", DecimalType()),
        StructField("t_espera_reb_fundo_esq_max", DecimalType()),
        StructField("t_espera_reb_fundo_dir", DecimalType()),
        StructField("t_espera_reb_fundo_dir_min", DecimalType()),
        StructField("t_espera_reb_fundo_dir_max", DecimalType()),
        StructField("retardo_recirculacao_de_ar_esq", IntegerType()),
        StructField("retardo_recirculacao_de_ar_esq_min", DecimalType()),
        StructField("retardo_recirculacao_de_ar_esq_max", DecimalType()),
        StructField("retardo_recirculacao_de_ar_dir", IntegerType()),
        StructField("retardo_recirculacao_de_ar_dir_min", DecimalType()),
        StructField("retardo_recirculacao_de_ar_dir_max", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_esq", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_esq_min", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_esq_max", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_dir", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_dir_min", DecimalType()),
        StructField("pos_resfrretavanco_batente2nd_dir_max", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_esq", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_esq_min", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_esq_max", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_dir", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_dir_min", DecimalType()),
        StructField("pos_resfrretavanco_batente3nd_dir_max", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_esq", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_esq_min", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_esq_max", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_dir", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_dir_min", DecimalType()),
        StructField("detector_de_furo_ret_avanco_batente_dir_max", DecimalType()),
        StructField("tempo_de_refrigeracao_do_molde_esq", IntegerType()),
        StructField("tempo_de_refrigeracao_do_molde_esq_min", IntegerType()),
        StructField("tempo_de_refrigeracao_do_molde_esq_max", DecimalType()),
        StructField("tempo_de_refrigeracao_do_molde_dir", IntegerType()),
        StructField("tempo_de_refrigeracao_do_molde_dir_min", IntegerType()),
        StructField("tempo_de_refrigeracao_do_molde_dir_max", DecimalType()),
        StructField("tempo_sopro_baixa_pressao_esq", IntegerType()),
        StructField("tempo_sopro_baixa_pressao_dir", IntegerType()),
        StructField("tempo_sopro_alta_pressao_esq", IntegerType()),
        StructField("tempo_sopro_alta_pressao_dir", IntegerType()),
        StructField("ret_avanca_carro", IntegerType()),
        StructField("ret_avanca_carro_min", IntegerType()),
        StructField("ret_avanca_carro_max", IntegerType()),
        StructField("retardo_subida_da_extrusora", DecimalType()),
        StructField("retardo_subida_da_extrusora_min", DecimalType()),
        StructField("retardo_subida_da_extrusora_max", DecimalType()),
        StructField("tempo_subida_extrusora", IntegerType()),
        StructField("tempo_subida_extrusora_min", IntegerType()),
        StructField("tempo_subida_extrusora_max", DecimalType()),
        StructField("retardo_corte_parison", DecimalType()),
        StructField("retardo_corte_parison_min", DecimalType()),
        StructField("retardo_corte_parison_max", DecimalType()),
        StructField("tempo_corte_parison", DecimalType()),
        StructField("tempo_corte_parison_min", DecimalType()),
        StructField("tempo_corte_parison_max", DecimalType()),
        StructField("retardo_ar_de_apoio", DecimalType()),
        StructField("retardo_ar_de_apoio_min", DecimalType()),
        StructField("retardo_ar_de_apoio_max", DecimalType()),
        StructField("tempo_ar_de_apoio1", IntegerType()),
        StructField("tempo_ar_de_apoio1min", IntegerType()),
        StructField("tempo_ar_de_apoio1max", IntegerType()),
        StructField("tempo_ar_de_apoio2", IntegerType()),
        StructField("tempo_ar_de_apoio2min", IntegerType()),
        StructField("tempo_ar_de_apoio2max", IntegerType()),
        StructField("esteira_rebarba_esq", IntegerType()),
        StructField("esteira_rebarba_esq_min", IntegerType()),
        StructField("esteira_rebarba_esq_max", IntegerType()),
        StructField("esteira_rebarba_dir", IntegerType()),
        StructField("esteira_rebarba_dir_min", IntegerType()),
        StructField("esteira_rebarba_dir_max", IntegerType()),
        StructField("tempo_min_inicio_extrusora", IntegerType()),
        StructField("tempo_min_inicio_extrusora_min", IntegerType()),
        StructField("tempo_min_inicio_extrusora_max", IntegerType()),
        StructField("ret_tempo_auto_ajuste_extrusora", DecimalType()),
        StructField("ret_tempo_auto_ajuste_extrusora_min", DecimalType()),
        StructField("ret_tempo_auto_ajuste_extrusora_max", DecimalType()),
        StructField("tempo_avanco_pinca_transf", DecimalType()),
        StructField("tempo_avanco_pinca_transf_min", DecimalType()),
        StructField("tempo_avanco_pinca_transf_max", DecimalType()),
        StructField("molde_abrir_posmm_esq", IntegerType()),
        StructField("molde_abrir_posmm_esq_min", IntegerType()),
        StructField("molde_abrir_posmm_esq_max", IntegerType()),
        StructField("molde_abrir_posmm_dir", IntegerType()),
        StructField("molde_abrir_posmm_dir_min", IntegerType()),
        StructField("molde_abrir_posmm_dir_max", IntegerType()),
        StructField("molde_abrir_velmms_esq", IntegerType()),
        StructField("molde_abrir_velmms_esq_min", IntegerType()),
        StructField("molde_abrir_velmms_esq_max", IntegerType()),
        StructField("molde_abrir_velmms_dir", IntegerType()),
        StructField("molde_abrir_velmms_dir_min", IntegerType()),
        StructField("molde_abrir_velmms_dir_max", IntegerType()),
        StructField("molde_fechar_posmm_esq", IntegerType()),
        StructField("molde_fechar_posmm_esq_min", IntegerType()),
        StructField("molde_fechar_posmm_esq_max", IntegerType()),
        StructField("molde_fechar_posmm_dir", IntegerType()),
        StructField("molde_fechar_posmm_dir_min", IntegerType()),
        StructField("molde_fechar_posmm_dir_max", IntegerType()),
        StructField("molde_fechar_velmms_esq", IntegerType()),
        StructField("molde_fechar_velmms_esq_min", IntegerType()),
        StructField("molde_fechar_velmms_esq_max", IntegerType()),
        StructField("molde_fechar_velmms_dir", IntegerType()),
        StructField("molde_fechar_velmms_dir_min", IntegerType()),
        StructField("molde_fechar_velmms_dir_max", IntegerType()),
        StructField("molde_fechadoposmm_esq", IntegerType()),
        StructField("molde_fechadoposmm_esq_min", IntegerType()),
        StructField("molde_fechadoposmm_esq_max", IntegerType()),
        StructField("molde_fechadoposmm_dir", IntegerType()),
        StructField("molde_fechadoposmm_dir_min", IntegerType()),
        StructField("molde_fechadoposmm_dir_max", IntegerType()),
        StructField("molde_fechado_vel_esq", IntegerType()),
        StructField("molde_fechado_vel_esq_min", IntegerType()),
        StructField("molde_fechado_vel_esq_max", IntegerType()),
        StructField("molde_fechado_vel_dir", IntegerType()),
        StructField("molde_fechado_vel_dir_min", IntegerType()),
        StructField("molde_fechado_vel_dir_max", IntegerType()),
        StructField("pre_abertura_mm_esq", IntegerType()),
        StructField("pre_abertura_mm_esq_min", IntegerType()),
        StructField("pre_abertura_mm_esq_max", IntegerType()),
        StructField("pre_abertura_mm_dir", IntegerType()),
        StructField("pre_abertura_mm_dir_min", IntegerType()),
        StructField("pre_abertura_mm_dir_max", IntegerType()),
        StructField("pre_abertura_esq", IntegerType()),
        StructField("pre_abertura_esq_min", IntegerType()),
        StructField("pre_abertura_esq_max", IntegerType()),
        StructField("pre_abertura_dir", IntegerType()),
        StructField("pre_abertura_dir_min", IntegerType()),
        StructField("pre_abertura_dir_max", IntegerType()),
        StructField("fechar_gavetamm_esq", IntegerType()),
        StructField("fechar_gavetamm_esq_min", IntegerType()),
        StructField("fechar_gavetamm_esq_max", IntegerType()),
        StructField("fechar_gavetamm_dir", IntegerType()),
        StructField("fechar_gavetamm_dir_min", IntegerType()),
        StructField("fechar_gavetamm_dir_max", IntegerType()),
        StructField("ret_alta_pressaomm_esq", IntegerType()),
        StructField("ret_alta_pressaomm_esq_min", IntegerType()),
        StructField("ret_alta_pressaomm_esq_max", IntegerType()),
        StructField("ret_alta_pressaomm_dir", IntegerType()),
        StructField("ret_alta_pressaomm_dir_min", IntegerType()),
        StructField("ret_alta_pressaomm_dir_max", IntegerType()),
        StructField("ret_alta_pressao_percentual_esq", IntegerType()),
        StructField("ret_alta_pressao_percentual_esq_min", IntegerType()),
        StructField("ret_alta_pressao_percentual_esq_max", IntegerType()),
        StructField("ret_alta_pressao_percentual_dir", IntegerType()),
        StructField("ret_alta_pressao_percentual_dir_min", IntegerType()),
        StructField("ret_alta_pressao_percentual_dir_max", IntegerType()),
        StructField("avanca_carro_pos_mm_esq", IntegerType()),
        StructField("avanca_carro_pos_mm_esq_min", IntegerType()),
        StructField("avanca_carro_pos_mm_esq_max", IntegerType()),
        StructField("avanca_carro_pos_mm_dir", IntegerType()),
        StructField("avanca_carro_pos_mm_dir_min", IntegerType()),
        StructField("avanca_carro_pos_mm_dir_max", IntegerType()),
        StructField("avanca_carrovel_mms_esq", IntegerType()),
        StructField("avanca_carrovel_mms_esq_min", IntegerType()),
        StructField("avanca_carrovel_mms_esq_max", IntegerType()),
        StructField("avanca_carrovel_mms_dir", IntegerType()),
        StructField("avanca_carrovel_mms_dir_min", IntegerType()),
        StructField("avanca_carrovel_mms_dir_max", IntegerType()),
        StructField("recua_carropos_mm_esq", IntegerType()),
        StructField("recua_carropos_mm_esq_min", IntegerType()),
        StructField("recua_carropos_mm_esq_max", IntegerType()),
        StructField("recua_carropos_mm_dir", IntegerType()),
        StructField("recua_carropos_mm_dir_min", IntegerType()),
        StructField("recua_carropos_mm_dir_max", IntegerType()),
        StructField("recua_carrovelmms_esq", IntegerType()),
        StructField("recua_carrovelmms_esq_min", IntegerType()),
        StructField("recua_carrovelmms_esq_max", IntegerType()),
        StructField("recua_carrovelmms_dir", IntegerType()),
        StructField("recua_carrovelmms_dir_min", IntegerType()),
        StructField("recua_carrovelmms_dir_max", IntegerType()),
        StructField("trava_o_avanco", IntegerType()),
        StructField("comprimento_parison", IntegerType()),
        StructField("de_parametros_individuais", IntegerType()),
        StructField("de_sensor_comprimento_individual", IntegerType()),
        StructField("a_seleciona_extrusora", IntegerType()),
        StructField("c_seleciona_extrusora", IntegerType()),
        StructField("pwds_seleciona", IntegerType()),
        StructField("selecione_rpm_extrusora_automatica", IntegerType()),
        StructField("lado_esquerdo", IntegerType()),
        StructField("rebarbador_superior_esq", IntegerType()),
        StructField("rebarbador_alca_esq", IntegerType()),
        StructField("pos_resfriamento_esq1st", IntegerType()),
        StructField("esteira_rebarbas_continua_esq", IntegerType()),
        StructField("selecionar_pinca_esq", IntegerType()),
        StructField("gaveta_fundo_esq", IntegerType()),
        StructField("rebarbador_fundo_esq", IntegerType()),
        StructField("selecionar_pinca_abaixar_esq", IntegerType()),
        StructField("rejeito_por_peso_esq", IntegerType()),
        StructField("seleciona_verf_rebarba_do_fundo_esq", IntegerType()),
        StructField("lado_direito", IntegerType()),
        StructField("rebarbador_superior_dir", IntegerType()),
        StructField("rebarbador_alca_dir", IntegerType()),
        StructField("pos_resfriamento_dir1st", IntegerType()),
        StructField("esteira_rebarbas_continua_dir", IntegerType()),
        StructField("selecionar_pinca_dir", IntegerType()),
        StructField("gaveta_fundo_dir", IntegerType()),
        StructField("rebarbador_fundo_dir", IntegerType()),
        StructField("selecionar_pinca_abaixar_dir", IntegerType()),
        StructField("rejeito_por_peso_dir", IntegerType()),
        StructField("seleciona_verf_rebarba_do_fundo_dir", IntegerType()),
        StructField("programador_p100", DecimalType()),
        StructField("programador_p75", DecimalType()),
        StructField("programador_p71", DecimalType()),
        StructField("programador_p68", DecimalType()),
        StructField("programador_p64", DecimalType()),
        StructField("programador_p60", DecimalType()),
        StructField("programador_p55", DecimalType()),
        StructField("programador_p50", DecimalType()),
        StructField("programador_p46", DecimalType()),
        StructField("programador_p37", DecimalType()),
        StructField("programador_p33", DecimalType()),
        StructField("programador_p29", DecimalType()),
        StructField("programador_p25", DecimalType()),
        StructField("programador_p21", DecimalType()),
        StructField("programador_p17", DecimalType()),
        StructField("programador_p13", DecimalType()),
        StructField("programador_p9", DecimalType()),
        StructField("programador_p1", DecimalType()),
        StructField("programador_p100min", DecimalType()),
        StructField("programador_p75min", DecimalType()),
        StructField("programador_p71min", DecimalType()),
        StructField("programador_p68min", DecimalType()),
        StructField("programador_p64min", DecimalType()),
        StructField("programador_p60min", DecimalType()),
        StructField("programador_p55min", DecimalType()),
        StructField("programador_p50min", DecimalType()),
        StructField("programador_p46min", DecimalType()),
        StructField("programador_p37min", DecimalType()),
        StructField("programador_p33min", DecimalType()),
        StructField("programador_p29min", DecimalType()),
        StructField("programador_p25min", DecimalType()),
        StructField("programador_p21min", DecimalType()),
        StructField("programador_p17min", DecimalType()),
        StructField("programador_p13min", DecimalType()),
        StructField("programador_p9min", DecimalType()),
        StructField("programador_p1min", DecimalType()),
        StructField("programador_p100max", DecimalType()),
        StructField("programador_p75max", DecimalType()),
        StructField("programador_p71max", DecimalType()),
        StructField("programador_p68max", DecimalType()),
        StructField("programador_p64max", DecimalType()),
        StructField("programador_p60max", DecimalType()),
        StructField("programador_p55max", DecimalType()),
        StructField("programador_p50max", DecimalType()),
        StructField("programador_p46max", DecimalType()),
        StructField("programador_p37max", DecimalType()),
        StructField("programador_p33max", DecimalType()),
        StructField("programador_p29max", DecimalType()),
        StructField("programador_p25max", DecimalType()),
        StructField("programador_p21max", DecimalType()),
        StructField("programador_p17max", DecimalType()),
        StructField("programador_p13max", DecimalType()),
        StructField("programador_p9max", DecimalType()),
        StructField("programador_p1max", DecimalType()),
        StructField("pwds_p83", IntegerType()),
        StructField("pwds_p79", DecimalType()),
        StructField("pwds_p76", DecimalType()),
        StructField("pwds_p73", DecimalType()),
        StructField("pwds_p68", DecimalType()),
        StructField("pwds_p65", DecimalType()),
        StructField("pwds_p61", DecimalType()),
        StructField("pwds_p57", DecimalType()),
        StructField("pwds_p54", DecimalType()),
        StructField("pwds_p51", DecimalType()),
        StructField("pwds_p48", IntegerType()),
        StructField("pwds_p46", DecimalType()),
        StructField("pwds_p41", DecimalType()),
        StructField("pwds_p33", IntegerType()),
        StructField("pwds_p31", DecimalType()),
        StructField("pwds_p28", DecimalType()),
        StructField("pwds_p24", DecimalType()),
        StructField("pwds_p20", DecimalType()),
        StructField("pwds_p17", DecimalType()),
        StructField("pwds_p15", DecimalType()),
        StructField("pwds_p13", DecimalType()),
        StructField("pwds_p10", IntegerType()),
        StructField("pwds_p83min", IntegerType()),
        StructField("pwds_p79min", DecimalType()),
        StructField("pwds_p76min", DecimalType()),
        StructField("pwds_p73min", DecimalType()),
        StructField("pwds_p68min", DecimalType()),
        StructField("pwds_p65min", DecimalType()),
        StructField("pwds_p61min", DecimalType()),
        StructField("pwds_p57min", DecimalType()),
        StructField("pwds_p54min", DecimalType()),
        StructField("pwds_p51min", DecimalType()),
        StructField("pwds_p48min", IntegerType()),
        StructField("pwds_p46min", DecimalType()),
        StructField("pwds_p41min", IntegerType()),
        StructField("pwds_p33min", IntegerType()),
        StructField("pwds_p31min", IntegerType()),
        StructField("pwds_p28min", DecimalType()),
        StructField("pwds_p24min", DecimalType()),
        StructField("pwds_p20min", DecimalType()),
        StructField("pwds_p17min", DecimalType()),
        StructField("pwds_p15min", DecimalType()),
        StructField("pwds_p13min", DecimalType()),
        StructField("pwds_p10min", IntegerType()),
        StructField("pwds_p83max", IntegerType()),
        StructField("pwds_p79max", DecimalType()),
        StructField("pwds_p76max", DecimalType()),
        StructField("pwds_p73max", DecimalType()),
        StructField("pwds_p68max", DecimalType()),
        StructField("pwds_p65max", DecimalType()),
        StructField("pwds_p61max", DecimalType()),
        StructField("pwds_p57max", DecimalType()),
        StructField("pwds_p54max", DecimalType()),
        StructField("pwds_p51max", DecimalType()),
        StructField("pwds_p48max", IntegerType()),
        StructField("pwds_p46max", DecimalType()),
        StructField("pwds_p41max", DecimalType()),
        StructField("pwds_p33max", IntegerType()),
        StructField("pwds_p31max", DecimalType()),
        StructField("pwds_p28max", DecimalType()),
        StructField("pwds_p24max", DecimalType()),
        StructField("pwds_p20max", DecimalType()),
        StructField("pwds_p17max", DecimalType()),
        StructField("pwds_p15max", DecimalType()),
        StructField("pwds_p13max", DecimalType()),
        StructField("pwds_p10max", IntegerType()),
        StructField("pre_aquecimento_a_adapt", IntegerType()),
        StructField("pre_aquecimento_a_cil1", IntegerType()),
        StructField("pre_aquecimento_a_cil2", IntegerType()),
        StructField("pre_aquecimento_a_cil3", IntegerType()),
        StructField("pre_aquecimento_b_adapt", IntegerType()),
        StructField("pre_aquecimento_b_cil1", IntegerType()),
        StructField("pre_aquecimento_b_cil2", IntegerType()),
        StructField("pre_aquecimento_b_cil3", IntegerType()),
        StructField("pre_aquecimento_b_cil4", IntegerType()),
        StructField("pre_aquecimento_b_cil5", IntegerType()),
        StructField("pre_aquecimento_cabecote1", IntegerType()),
        StructField("pre_aquecimento_cabecote2", IntegerType()),
        StructField("pre_aquecimento_cabecote3", IntegerType()),
        StructField("pre_aquecimento_cabecote4", IntegerType()),
        StructField("pre_aquecimento_cabecote5", IntegerType()),
        StructField("pre_aquecimento_c_adapt", IntegerType()),
        StructField("pre_aquecimento_c_cil1", IntegerType()),
        StructField("pre_aquecimento_c_cil2", IntegerType()),
        StructField("pre_aquecimento_c_cil3", IntegerType()),
        StructField("dosador_1A", DecimalType()),
        StructField("dosador_1B", DecimalType()),
        StructField("dosador_2A", DecimalType()),
        StructField("dosador_2B", DecimalType()),
        StructField("dosador_3A", DecimalType()),
        StructField("dosador_3B", DecimalType()),
        StructField("user_id_insert", LongType()),
        StructField("date_insert", StringType()),
        StructField("user_id_update", LongType()),
        StructField("date_update", StringType()),
        StructField("access_key", StringType())
    ])

    @classmethod
    def extractFtpRgDD(self):
        df = KafkaServer()
        df = df.get_df(self.SCHEMA, self.TOPIC, stream=False)
        df = df.selectExpr("CAST(after as STRING)")
        df = df.select(from_json(df.after, self.SCHEMA).alias("data")).select("data.*")
        df.show()
        return df

df_stg = FtpRgDD.extractFtpRgDD()


if __name__ == "__main__":
    pass    
        